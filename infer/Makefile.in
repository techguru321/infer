# Copyright (c) 2015 - present Facebook, Inc.
# All rights reserved.
#
# This source code is licensed under the BSD style license found in the
# LICENSE file in the root directory of this source tree. An additional grant
# of patent rights can be found in the PATENTS file in the same directory.

@SET_MAKE@
ROOT_DIR = ..

include $(ROOT_DIR)/Makefile.config

all: infer $(INFER_BIN_RELPATH) $(INFERTRACEBUGS_BIN_RELPATH)

$(INFER_BIN_RELPATH) $(INFERTRACEBUGS_BIN_RELPATH):
	($(REMOVE) $@ && \
	 cd $(@D) && \
	 $(LN_S) ../lib/python/$(@F) $(@F))

infer: $(INFER_BIN_RELPATH)
	$(MAKE) -C $(SRC_DIR) infer
ifeq (@BUILD_JAVA_ANALYZERS@,yes)
	$(MAKE) -C $(ANNOTATIONS_DIR)
endif
	$(MAKE) -C $(MODELS_DIR) all

clean:
	$(MAKE) -C $(SRC_DIR) clean
	$(MAKE) -C $(ANNOTATIONS_DIR) clean
	$(MAKE) -C $(MODELS_DIR) clean
	$(REMOVE) $(INFER_BIN_RELPATH) $(INFERTRACEBUGS_BIN_RELPATH)

.PHONY: all clean infer
